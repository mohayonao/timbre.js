<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Pragmatic Synth</title><link rel="stylesheet" href="/timbre.js/misc/css/codemirror.css" type="text/css"><link rel="stylesheet" href="/timbre.js/misc/css/common.css" type="text/css"><link rel="shortcut icon" href="/timbre.js/favicon.ico"><script src="/timbre.js/timbre.dev.js"></script><script>var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-21613416-10']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script></head><body><div id="sidebar"><h1>timbre.js</h1><div id="index"><div id="list"><h2>Download (13.08.03)</h2><ul><li><a href="/timbre.js/timbre.js">timbre.js</a></li><li><a href="/timbre.js/timbre.dev.js">timbre.dev.js</a></li></ul><h2>Documents</h2><ul><li><a href="./">Introduction</a></li><li><a href="./GettingStarted.html">Getting Started</a></li><li><a href="./PragmaSynth.html">Pragmatic Synth</a></li><li><a href="./RecordingMode.html">Recording Mode</a></li><li><a href="./CustomObject.html">Custom Object</a></li><li><a href="./ForDevelopers.html">For Developers</a></li><li><a href="./timevalue.html">timevalue</a></li></ul><h2>Examples</h2><ul><li><a href="./beatbox.html">BeatBox</a></li><li><a href="./chord.html">ChordWork</a></li><li><a href="./satie.html">Gymnopedie</a></li><li><a href="./khoomii.html">Khoomii</a></li><li><a href="./reich.html">Reich</a></li></ul><h2>References</h2><ul><li><a href="./BaseObject.html">TimbreObject</a></li><li><a href="./Number.html">Number</a></li><li><a href="./Array.html">Array</a></li><li><a href="./Function.html">Function</a></li><li><a href="./Boolean.html">Boolean</a></li><li><a href="./Object.html">Object</a></li><li><a href="./SynthDef.html">SynthDef</a></li><li><a href="./soundbuffer.html">SoundBuffer</a></li><li><a href="./mul.html">*</a></li><li><a href="./add.html">+</a></li><li><a href="./subtract.html">-</a></li><li><a href="./div.html">/</a></li><li><a href="./audio.html">audio</a></li><li><a href="./biquad.html">biquad</a></li><li><a href="./buffer.html">buffer</a></li><li><a href="./chorus.html">chorus</a></li><li><a href="./clip.html">clip</a></li><li><a href="./comp.html">comp</a></li><li><a href="./delay.html">delay</a></li><li><a href="./dist.html">dist</a></li><li><a href="./env.html">env</a></li><li><a href="./eq.html">eq</a></li><li><a href="./fft.html">fft</a></li><li><a href="./fnoise.html">fnoise</a></li><li><a href="./gate.html">gate</a></li><li><a href="./ifft.html">ifft</a></li><li><a href="./interval.html">interval</a></li><li><a href="./lag.html">lag</a></li><li><a href="./map.html">map</a></li><li><a href="./max.html">max</a></li><li><a href="./mediastream.html">mediastream</a></li><li><a href="./midicps.html">midicps</a></li><li><a href="./midiratio.html">midiratio</a></li><li><a href="./min.html">min</a></li><li><a href="./mml.html">mml</a></li><li><a href="./mono.html">mono</a></li><li><a href="./ndict.html">ndict</a></li><li><a href="./noise.html">noise</a></li><li><a href="./osc.html">osc</a></li><li><a href="./OscGen.html">OscGen</a></li><li><a href="./pan.html">pan</a></li><li><a href="./param.html">param</a></li><li><a href="./phaser.html">phaser</a></li><li><a href="./pink.html">pink</a></li><li><a href="./pluck.html">pluck</a></li><li><a href="./PluckGen.html">PluckGen</a></li><li><a href="./rec.html">rec</a></li><li><a href="./reverb.html">reverb</a></li><li><a href="./schedule.html">schedule</a></li><li><a href="./scope.html">scope</a></li><li><a href="./script.html">script</a></li><li><a href="./selector.html">selector</a></li><li><a href="./spectrum.html">spectrum</a></li><li><a href="./tape.html">tape</a></li><li><a href="./task.html">task</a></li><li><a href="./timeout.html">timeout</a></li><li><a href="./waveshaper.html">waveshaper</a></li><li><a href="./zmap.html">zmap</a></li></ul><h2>Extra objects</h2><ul><li><a href="./mp3_decode.html">mp3_decode</a></li><li><a href="./soundfont.html">soundfont</a></li><li><a href="./audiojsonp.html">audio.jsonp</a></li><li><a href="./cosc.html">cosc</a></li><li><a href="./keyboard.html">keyboard</a></li><li><a href="./MoogFF.html">MoogFF</a></li><li><a href="./mouse.html">mouse</a></li><li><a href="./webaudioapi.html">WebAudioAPI</a></li></ul></div></div><hr><div id="footer"><a href="/timbre.js/">English</a><a href="/timbre.js/ja/">日本語</a></div></div><div id="main"><h1>Pragmatic Synth</h1>
<p>Make a Synthesizer</p>
<p> VCO - VCA - VCF モデルの簡単なシンセサイザーを作ります。</p>
<h2>UI</h2>
<p> グラフィカルな UI は説明が膨大になるため省略し、簡易的に以下の仕様のインターフェースを使用します。</p>
<ul>
<li><a href="./keyboard.html"><code>T(&quot;keyboard&quot;)</code></a> gets input from the keyboard <em>(line:5)</em> </li>
<li><a href="./ndict.html"><code>T(&quot;ndict.key&quot;)</code></a> converts from a key code to a MIDI note number <em>(line:6)</em></li>
<li><a href="./midicps.html"><code>T(&quot;midicps&quot;)</code></a> converts from a MIDI note number to a frequency <em>(line:8)</em></li>
</ul>
<p><img src="/timbre.js/misc/img/keymap.png" alt="Keymap"></p>
<div class="codemirror" lang="timbre" source="var synth = T(&quot;OscGen&quot;, {wave:&quot;saw&quot;, mul:0.25}).play();

var keydict = T(&quot;ndict.key&quot;);
var midicps = T(&quot;midicps&quot;);
T(&quot;keyboard&quot;).on(&quot;keydown&quot;, function(e) {
  var midi = keydict.at(e.keyCode);
  if (midi) {
    var freq = midicps.at(midi);
    synth.noteOnWithFreq(freq, 100);
  }
}).on(&quot;keyup&quot;, function(e) {
  var midi = keydict.at(e.keyCode);
  if (midi) {
    synth.noteOff(midi, 100);
  }
}).start();"></div>
<h2>VCO (Voltage Controlled Oscillator)</h2>
<div class="codemirror" lang="timbre" source="var VCO = T(&quot;saw&quot;, {freq:880, mul:0.2}).play();"></div>
<p> キーボードによる周波数の制御 <em>(line:8)</em></p>
<div class="codemirror" lang="timbre" source="var VCO = T(&quot;saw&quot;, {freq:880, mul:0.2}).play();

var keydict = T(&quot;ndict.key&quot;);
var midicps = T(&quot;midicps&quot;);
T(&quot;keyboard&quot;).on(&quot;keydown&quot;, function(e) {
  var midi = keydict.at(e.keyCode);
  if (midi) {
    VCO.freq.value = midicps.at(midi);
  }
}).start();"></div>
<p> <code>T(&quot;osc&quot;).freq</code> は数値以外の T オブジェクトを入力することができます <em>(line:2)</em>。以下の例では時間変化する T オブジェクト を周波数プロパティの入力にしてビブラートやポルタメントを行なっています。</p>
<h3>Vibrato</h3>
<div class="codemirror" lang="timbre" source="var LFO = T(&quot;sin&quot;, {freq:&quot;250ms&quot;, mul:5, add:880}).kr();
var VCO = T(&quot;saw&quot;, {freq:LFO, mul:0.2}).play();

var keydict = T(&quot;ndict.key&quot;);
var midicps = T(&quot;midicps&quot;);
T(&quot;keyboard&quot;).on(&quot;keydown&quot;, function(e) {
  var midi = keydict.at(e.keyCode);
  if (midi) {
    LFO.add = midicps.at(midi);
  }
}).start();"></div>
<h3>Portament</h3>
<p> <code>T(&quot;param&quot;)</code> を使用して周波数を滑かに変化させる <em>(line:1,2,9)</em></p>
<div class="codemirror" lang="timbre" source="var glide = T(&quot;param&quot;, {value:880});
var VCO   = T(&quot;saw&quot;  , {freq:glide, mul:0.2}).play();

var keydict = T(&quot;ndict.key&quot;);
var midicps = T(&quot;midicps&quot;);
T(&quot;keyboard&quot;).on(&quot;keydown&quot;, function(e) {
  var midi = keydict.at(e.keyCode);
  if (midi) {
    glide.linTo(midicps.at(midi), &quot;100ms&quot;);
  }
}).start();"></div>
<h3>Sound Effect</h3>
<p> エンベロープオブジェクト <code>T(&quot;env&quot;)</code> で周波数の変化を直接記述する。</p>
<div class="codemirror" lang="timbre" source="// Change from 1760Hz to 220Hz in 200ms.
var table = [1760, [110, &quot;200ms&quot;]];

var freq = T(&quot;env&quot;, {table:table}).on(&quot;bang&quot;, function() {
    VCO.mul = 0.2;
}).on(&quot;ended&quot;, function() {
    VCO.mul = 0;
});
var VCO = T(&quot;saw&quot;, {freq:freq, mul:0}).play();

var keydict = T(&quot;ndict.key&quot;);
var midicps = T(&quot;midicps&quot;);
T(&quot;keyboard&quot;).on(&quot;keydown&quot;, function(e) {
  freq.bang(); // Start the envelope
}).start();"></div>
<h2>VCF</h2>
<p> <strong>Voltage Controlled Filter</strong>. timbre.js では <a href="./biquad.html"><code>T(&quot;biquad&quot;)</code></a> を使用します。</p>
<div class="codemirror" lang="timbre" source="var VCO = T(&quot;saw&quot;, {mul:0.2});
var VCF = T(&quot;lpf&quot;, {cutoff:1600, Q:10}, VCO).play();

var keydict = T(&quot;ndict.key&quot;);
var midicps = T(&quot;midicps&quot;);
T(&quot;keyboard&quot;).on(&quot;keydown&quot;, function(e) {
  var midi = keydict.at(e.keyCode);
  if (midi) {
    VCO.freq.value = midicps.at(midi);
  }
}).start();"></div>
<h3>Envelope Filtering</h3>
<p> エンベロープオブジェクト <code>T(&quot;env&quot;)</code> でカットオフ周波数を時間変化させる。</p>
<p><em>(line:1,2,12,13)</em></p>
<div class="codemirror" lang="timbre" source="var table = [200, [4800, 150], [2400, 500]];
var cutoff = T(&quot;env&quot;, {table:table}).bang();

var VCO = T(&quot;saw&quot;, {mul:0.2});
var VCF = T(&quot;lpf&quot;, {cutoff:cutoff, Q:10}, VCO).play();

var keydict = T(&quot;ndict.key&quot;);
var midicps = T(&quot;midicps&quot;);
T(&quot;keyboard&quot;).on(&quot;keydown&quot;, function(e) {
  var midi = keydict.at(e.keyCode);
  if (midi) {
    VCO.freq.value = midicps.at(midi);
    cutoff.bang();
  }
}).start();"></div>
<h3>Auto Wah</h3>
<p> LFOでカットオフ周波数を時間変化させる。</p>
<p><em>(line:1,13,14)</em></p>
<div class="codemirror" lang="timbre" source="var cutoff = T(&quot;sin&quot;, {freq:&quot;400ms&quot;, mul:300, add:1760}).kr();

var VCO = T(&quot;saw&quot;, {mul:0.2});
var VCF = T(&quot;lpf&quot;, {cutoff:cutoff, Q:20}, VCO).play();

var keydict = T(&quot;ndict.key&quot;);
var midicps = T(&quot;midicps&quot;);
T(&quot;keyboard&quot;).on(&quot;keydown&quot;, function(e) {
  var midi = keydict.at(e.keyCode);
  if (midi) {
    var freq = midicps.at(midi);
    VCO.freq.value   = freq;
    cutoff.add.value = freq * 2;
    cutoff.bang();
  }
}).start();"></div>
<h2>VCA</h2>
<p> <strong>Voltage Controlled Amplifier</strong>. timbre.js では <a href="./env.html"><code>T(&quot;env&quot;)</code></a> や <a href="./param.html"><code>T(&quot;param&quot;)</code></a> を使います。</p>
<h3>Amplitude Envelope</h3>
<p> 一般的な ADSRエンベロープ。
<em>(line:2,10,15)</em></p>
<div class="codemirror" lang="timbre" source="var VCO = T(&quot;saw&quot; , {mul:0.2});
var EG  = T(&quot;adsr&quot;, {a:100, d:1500, s:0.75, r:500}, VCO).play();

var keydict = T(&quot;ndict.key&quot;);
var midicps = T(&quot;midicps&quot;);
T(&quot;keyboard&quot;).on(&quot;keydown&quot;, function(e) {
  var midi = keydict.at(e.keyCode);
  if (midi) {
    VCO.freq.value = midicps.at(midi);
    EG.bang();
  }
}).on(&quot;keyup&quot;, function(e) {
  var midi = keydict.at(e.keyCode);
  if (midi) {
    EG.release();
  }
}).start();"></div>
<h3>Tremolo</h3>
<p> LFOでトレモロ効果。
<em>(line:2,3)</em></p>
<div class="codemirror" lang="timbre" source="var VCO = T(&quot;saw&quot; , {mul:0.5});
var EG  = T(&quot;+tri&quot;, {freq:&quot;50ms&quot;, mul:0.2, add:0.5});
var synth = T(&quot;*&quot;, VCO, EG).play();

var keydict = T(&quot;ndict.key&quot;);
var midicps = T(&quot;midicps&quot;);
T(&quot;keyboard&quot;).on(&quot;keydown&quot;, function(e) {
  var midi = keydict.at(e.keyCode);
  if (midi) {
    VCO.freq.value = midicps.at(midi);
  }
}).start();"></div>
<h2>Polyphonic</h2>
<p> 今までの例ではモノフォニックだったが、<code>T(&quot;SynthDef&quot;)</code> オブジェクトを使用すると最低限の記述でポリフォニックシンセを作成できる。</p>
<div class="codemirror" lang="timbre" source="var synth = T(&quot;SynthDef&quot;).play();

synth.def = function(opts) {
  var VCO = T(&quot;saw&quot;, {freq:opts.freq});

  var cutoff = T(&quot;env&quot;, {table:[8000, [opts.freq, 500]]}).bang();
  var VCF    = T(&quot;lpf&quot;, {cutoff:cutoff, Q:5}, VCO);

  var EG  = T(&quot;adsr&quot;, {a:150, d:500, s:0.45, r:1500, lv:0.6});
  var VCA = EG.append(VCF).bang();

  return VCA;
};

var keydict = T(&quot;ndict.key&quot;);
T(&quot;keyboard&quot;).on(&quot;keydown&quot;, function(e) {
  var midi = keydict.at(e.keyCode);
  if (midi) {
    synth.noteOn(midi);
  }
}).on(&quot;keyup&quot;, function(e) {
  var midi = keydict.at(e.keyCode);
  if (midi) {
    synth.noteOff(midi);
  }
}).start();"></div>
<script src="/timbre.js/src/extras/keyboard.js"></script>
</div><script src="/timbre.js/misc/js/jquery.js"></script><script src="/timbre.js/misc/js/codemirror.js"></script><script src="/timbre.js/misc/js/javascript.js"></script><script src="/timbre.js/misc/js/xml.js"></script><script src="/timbre.js/misc/js/htmlmixed.js"></script><script src="/timbre.js/misc/js/subcollider.js"></script><script src="/timbre.js/misc/js/common.js"></script></body></html>