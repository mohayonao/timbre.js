<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>T(&quot;env&quot;)</title><link rel="stylesheet" href="/timbre.js/misc/css/codemirror.css" type="text/css"><link rel="stylesheet" href="/timbre.js/misc/css/common.css" type="text/css"><link rel="shortcut icon" href="/timbre.js/favicon.ico"><script src="/timbre.js/timbre.dev.js"></script><script>var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-21613416-10']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script></head><body><div id="sidebar"><h1>timbre.js</h1><div id="index"><div id="list"><h2>Download (13.05.03)</h2><ul><li><a href="/timbre.js/timbre.js">timbre.js</a></li><li><a href="/timbre.js/timbre.dev.js">timbre.dev.js</a></li></ul><h2>Documents</h2><ul><li><a href="./">Introduction</a></li><li><a href="./GettingStarted.html">Getting Started</a></li><li><a href="./PragmaSynth.html">Pragmatic Synth</a></li><li><a href="./RecordingMode.html">Recording Mode</a></li><li><a href="./CustomObject.html">Custom Object</a></li><li><a href="./ForDevelopers.html">For Developers</a></li><li><a href="./timevalue.html">timevalue</a></li></ul><h2>Examples</h2><ul><li><a href="./beatbox.html">BeatBox</a></li><li><a href="./chord.html">ChordWork</a></li><li><a href="./satie.html">Gymnopedie</a></li><li><a href="./khoomii.html">Khoomii</a></li><li><a href="./reich.html">Reich</a></li></ul><h2>References</h2><ul><li><a href="./BaseObject.html">TimbreObject</a></li><li><a href="./Number.html">Number</a></li><li><a href="./Array.html">Array</a></li><li><a href="./Function.html">Function</a></li><li><a href="./Boolean.html">Boolean</a></li><li><a href="./Object.html">Object</a></li><li><a href="./SynthDef.html">SynthDef</a></li><li><a href="./soundbuffer.html">SoundBuffer</a></li><li><a href="./mul.html">*</a></li><li><a href="./add.html">+</a></li><li><a href="./subtract.html">-</a></li><li><a href="./div.html">/</a></li><li><a href="./audio.html">audio</a></li><li><a href="./biquad.html">biquad</a></li><li><a href="./buffer.html">buffer</a></li><li><a href="./chorus.html">chorus</a></li><li><a href="./clip.html">clip</a></li><li><a href="./comp.html">comp</a></li><li><a href="./delay.html">delay</a></li><li><a href="./dist.html">dist</a></li><li><a href="./env.html">env</a></li><li><a href="./eq.html">eq</a></li><li><a href="./fft.html">fft</a></li><li><a href="./fnoise.html">fnoise</a></li><li><a href="./gate.html">gate</a></li><li><a href="./ifft.html">ifft</a></li><li><a href="./interval.html">interval</a></li><li><a href="./lag.html">lag</a></li><li><a href="./map.html">map</a></li><li><a href="./max.html">max</a></li><li><a href="./mediastream.html">mediastream</a></li><li><a href="./midicps.html">midicps</a></li><li><a href="./midiratio.html">midiratio</a></li><li><a href="./min.html">min</a></li><li><a href="./mml.html">mml</a></li><li><a href="./mono.html">mono</a></li><li><a href="./ndict.html">ndict</a></li><li><a href="./noise.html">noise</a></li><li><a href="./osc.html">osc</a></li><li><a href="./OscGen.html">OscGen</a></li><li><a href="./pan.html">pan</a></li><li><a href="./param.html">param</a></li><li><a href="./phaser.html">phaser</a></li><li><a href="./pink.html">pink</a></li><li><a href="./pluck.html">pluck</a></li><li><a href="./PluckGen.html">PluckGen</a></li><li><a href="./rec.html">rec</a></li><li><a href="./reverb.html">reverb</a></li><li><a href="./schedule.html">schedule</a></li><li><a href="./scope.html">scope</a></li><li><a href="./script.html">script</a></li><li><a href="./selector.html">selector</a></li><li><a href="./spectrum.html">spectrum</a></li><li><a href="./tape.html">tape</a></li><li><a href="./task.html">task</a></li><li><a href="./timeout.html">timeout</a></li><li><a href="./waveshaper.html">waveshaper</a></li><li><a href="./zmap.html">zmap</a></li></ul><h2>Extra objects</h2><ul><li><a href="./audiojsonp.html">audio.jsonp</a></li><li><a href="./cosc.html">cosc</a></li><li><a href="./keyboard.html">keyboard</a></li><li><a href="./MoogFF.html">MoogFF</a></li><li><a href="./mouse.html">mouse</a></li><li><a href="./webaudioapi.html">WebAudioAPI</a></li></ul></div></div><hr><div id="footer"><a href="/timbre.js/">English</a><a href="/timbre.js/ja/">日本語</a></div></div><div id="main"><h1>T(&quot;env&quot;)</h1>
<p><span class="label kr">KR/AR</span> Envelope

</p>
<h2>Description</h2>
<p> エンベロープを定義し、<code>bang()</code>を受けて動作します。インプットがない場合はエンベロープ値のみを、インプットがある場合はインプットを加算したものにエンベロープ値を積算して出力します。

</p>
<div class="codemirror" lang="timbre" source="var table = [0.8, [0, 1500]];
T(&quot;env&quot;, {table:table}, T(&quot;sin&quot;)).on(&quot;ended&quot;, function() {
    this.pause();
}).bang().play();"></div>
<p> エンベロープの形状は <code>table</code> プロパティで指定します。<code>table</code> は <code>初期値</code> に続いて <code>[次の値, 時間(ms), カーブの種類]</code> の子配列を要素に持つ配列です。以下の例では 440Hzから 0.5秒かけて 880Hzに上昇し、0.25秒で 660Hzに遷移するエンベロープをオシレーターの周波数の入力として 3回動作させています。

</p>
<div class="codemirror" lang="timbre" source="var table = [440, [880, 500], [660, 250]];
var env   = T(&quot;env&quot;, {table:table}).bang();
var synth = T(&quot;saw&quot;, {freq:env, mul:0.25});

var interval = T(&quot;interval&quot;, {interval:1000}, function(count) {
  if (count === 3) {
    interval.stop();
  }
  env.bang();
}).set({buddies:synth}).start();"></div>
<canvas id="releaseNode" style="width:240px;height:80px"></canvas>
<p> <code>releaseNode</code> プロパティを指定すると、 <code>release()</code> メソッドをトリガするまで持続するエンベロープを作成できます。以下の例では 3番目の要素をリリースノードとすることで直前の値 0.6 まで遷移した後、持続して <code>release()</code> がトリガされてから 1秒かけて 0 に遷移するエンベロープを動作させています。

</p>
<div class="codemirror" lang="timbre" source="var table = [0, [1, 100], [0.6, 100], [0, 1000]];
var synth = T(&quot;saw&quot;, {mul:0.25});
var env   = T(&quot;env&quot;, {table:table, releaseNode:3}, synth).on(&quot;ended&quot;, function() {
  this.pause();
}).bang().play();

env.plot({target:releaseNode});

var timeout = T(&quot;timeout&quot;, {timeout:2000}, function() {
  env.release();
  timeout.stop();
}).start();"></div>
<canvas id="loopNode" style="width:240px;height:80px"></canvas>
<p> <code>loopNode</code> プロパティを指定すると、エンベロープの末尾まで到達した後、リリースノード以降を繰り返すエンベロープを作成できます。以下の例では 1番目の要素をループノードとすることで周期的に変化するエンベロープを作成して、オシレーターの周波数の入力とすることでビブラートを行っています。<code>releaseNode</code> と合わせて使用した場合、ループノードとリリースノードの間でループします。

</p>
<div class="codemirror" lang="timbre" source="var table = [440, [460, 50], [430, 150]];
var env   = T(&quot;env&quot;, {table:table, loopNode:1}).bang();
var synth = T(&quot;tri&quot;, {freq:env, mul:0.25});

env.plot({target:loopNode});

var timeout = T(&quot;timeout&quot;, {timeout:2000}, function() {
  timeout.stop();
}).set({buddies:synth}).start();"></div>
<h2>Properties</h2>
<ul>
<li><code>table</code> <em>(Array)</em></li>
<li><code>curve</code> <em>(String &quot;lin&quot; or &quot;exp&quot;)</em></li>
<li><code>releaseNode</code> <em>(Number)</em></li>
<li><code>loopNode</code> <em>(Number)</em></li>
</ul>
<h2>Methods</h2>
<ul>
<li><code>bang()</code><ul>
<li>エンベロープを起動します</li>
</ul>
</li>
<li><code>release()</code><ul>
<li>リリースフェーズに移行します</li>
</ul>
</li>
</ul>
<h2>Events</h2>
<ul>
<li><code>sustained</code><ul>
<li>エンベロープが持続フェーズに入ったときに発生します</li>
</ul>
</li>
<li><code>released</code><ul>
<li>リリースメソッドが呼ばれたときに発生します</li>
</ul>
</li>
<li><code>ended</code><ul>
<li>エンベロープが終了したときに発生します</li>
</ul>
</li>
</ul>
<h2>Tips</h2>
<canvas id="plot" style="width:240px;height:80px"></canvas>
<ul>
<li>カーブの種類は <code>&quot;lin&quot;</code> か <code>&quot;exp&quot;</code> を指定できます。</li>
<li><code>curve</code> プロパティでデフォルトのカーブの種類を設定できます。</li>
<li><code>plot()</code> メソッドでエンベロープの形状を描画します。</li>
<li>時間は <strong>timevalue形式</strong>の文字列でも指定できます。</li>
</ul>
<div class="codemirror" lang="timbre" source="var table = [0, [0.8, &quot;BPM120 L8&quot;], [0.4, &quot;BPM120 L16&quot;],
                [0.5, 80], [0.4, 80], [0, &quot;BPM120 L4&quot;, &quot;lin&quot;]];
var env = T(&quot;env&quot;, {table:table, loopNode:3, releaseNode:5, curve:&quot;exp&quot;});

env.plot({target:plot});

env.append(T(&quot;pulse&quot;, {mul:0.25})).on(&quot;ended&quot;, function() {
    this.pause();
}).bang().play();

var timeout = T(&quot;timeout&quot;, {timeout:2000}, function() {
  env.release();
  timeout.stop();
}).start();"></div>
<h2>Constructors</h2>
<p> <code>T(&quot;env&quot;)</code> クラスには便利なコンストラクタが用意されています。それらを使えば、最小限のパラメータでエンベロープテーブルを作成することができます。

</p>
<h3>T(&quot;perc&quot;)</h3>
<canvas id="perc" style="width:240px;height:80px"></canvas>
<p> <code>T(&quot;perc&quot;)</code> はパーカッシブなエンベロープを作ります。

</p>
<ul>
<li>a, attackTime: 10</li>
<li>r, releaseTime: 300</li>
<li>lv, level: 0</li>
</ul>
<div class="codemirror" lang="timbre" source="var env = T(&quot;perc&quot;, {r:500}, T(&quot;sin&quot;)).on(&quot;ended&quot;, function() {
  this.pause();
}).bang().play();

env.plot({target:perc});"></div>
<h3>T(&quot;adsr&quot;)</h3>
<canvas id="adsr" style="width:240px;height:80px"></canvas>
<p> <code>T(&quot;adsr&quot;)</code> はADSRタイプの持続エンベロープを作ります。

</p>
<ul>
<li>a, attackTime : 10</li>
<li>d, decayTime : 300</li>
<li>s, sustainLevel : 0.5</li>
<li>r, releaseTime : 1000</li>
<li>lv, totalLevel : 1</li>
</ul>
<div class="codemirror" lang="timbre" source="var env = T(&quot;adsr&quot;, {a:100,d:250,s:0.6,r:500}, T(&quot;sin&quot;)).on(&quot;ended&quot;, function() {
  this.pause();
}).bang().play();

env.plot({target:adsr});

var timeout = T(&quot;timeout&quot;, {timeout:1500}, function() {
  env.release();
  timeout.stop();
}).start();"></div>
<h3>T(&quot;adshr&quot;)</h3>
<canvas id="adshr" style="width:240px;height:80px"></canvas>
<p> <code>T(&quot;adshr&quot;)</code> はADSHRタイプのエンベロープを作ります。

</p>
<ul>
<li>a, attackTime : 10</li>
<li>d, decayTime : 300</li>
<li>s, sustainLevel : 0.5</li>
<li>h, holdTime: 500</li>
<li>r, releaseTime : 1000</li>
<li>lv, totalLevel : 1</li>
</ul>
<div class="codemirror" lang="timbre" source="var env = T(&quot;adshr&quot;, {a:100,d:250,s:0.6,r:500}, T(&quot;sin&quot;)).on(&quot;ended&quot;, function() {
  this.pause();
}).bang().play();

env.plot({target:adshr});"></div>
<h3>T(&quot;asr&quot;)</h3>
<canvas id="asr" style="width:240px;height:80px"></canvas>
<p> <code>T(&quot;asr&quot;)</code> はASRタイプの持続エンベロープを作ります。

</p>
<ul>
<li>a, attackTime : 10</li>
<li>s, sustainLevel : 0.5</li>
<li>r, releaseTime : 1000</li>
<li>lv, totalLevel : 1</li>
</ul>
<div class="codemirror" lang="timbre" source="var env = T(&quot;asr&quot;, {a:100,s:0.8,r:500}, T(&quot;sin&quot;)).on(&quot;ended&quot;, function() {
  this.pause();
}).bang().play();

env.plot({target:asr});

var timeout = T(&quot;timeout&quot;, {timeout:1500}, function() {
  env.release();
  timeout.stop();
}).start();"></div>
<h3>T(&quot;dadsr&quot;)</h3>
<canvas id="dadsr" style="width:240px;height:80px"></canvas>
<p> <code>T(&quot;dadsr&quot;)</code> は DADSRタイプの持続エンベロープを作ります。

</p>
<ul>
<li>dl, delayTime : 100</li>
<li>a, attackTime : 10</li>
<li>s, sustainLevel : 0.5</li>
<li>r, releaseTime : 1000</li>
<li>lv, totalLevel : 1</li>
</ul>
<div class="codemirror" lang="timbre" source="var env = T(&quot;dadsr&quot;, {dl:500,r:500}, T(&quot;sin&quot;)).on(&quot;ended&quot;, function() {
  this.pause();
}).bang().play();

env.plot({target:dadsr});

var timeout = T(&quot;timeout&quot;, {timeout:1500}, function() {
  env.release();
  timeout.stop();
}).start();"></div>
<h3>T(&quot;ahdsfr&quot;)</h3>
<canvas id="ahdsfr" style="width:240px;height:80px"></canvas>
<p> <code>T(&quot;ahdsfr&quot;)</code> は AHDSFRタイプの持続エンベロープを作ります。

</p>
<ul>
<li>a, attackTime : 10</li>
<li>h, holdTime : 10</li>
<li>d, decayTime : 300</li>
<li>s, sustainLevel : 0.5</li>
<li>f, fadeTime : 5000</li>
<li>r, releaseTime : 1000</li>
<li>lv, totalLevel : 1</li>
</ul>
<div class="codemirror" lang="timbre" source="var env = T(&quot;ahdsfr&quot;, {a:100, h:150, s:0.8, f:5000, r:500}, T(&quot;sin&quot;)).on(&quot;ended&quot;, function() {
  this.pause();
}).bang().play();

env.plot({target:ahdsfr});

var timeout = T(&quot;timeout&quot;, {timeout:1500}, function() {
  env.release();
  timeout.stop();
}).start();"></div>
<h3>T(&quot;linen&quot;)</h3>
<canvas id="linen" style="width:240px;height:80px"></canvas>
<p> <code>T(&quot;linen&quot;)</code> は台形エンベロープを作ります。

</p>
<ul>
<li>a, attackTime : 10</li>
<li>s, sustainTime : 1000</li>
<li>r, releaseTime : 1000</li>
<li>lv, totalLevel : 1</li>
</ul>
<div class="codemirror" lang="timbre" source="var env = T(&quot;linen&quot;, {a:200, lv:0.8}, T(&quot;sin&quot;)).on(&quot;ended&quot;, function() {
  this.pause();
}).bang().play();

env.plot({target:linen});"></div>
<h3>T(&quot;env.tri&quot;)</h3>
<canvas id="env_tri" style="width:240px;height:80px"></canvas>
<p> <code>T(&quot;env.tri&quot;)</code> は三角エンベロープを作ります。

</p>
<ul>
<li>dur, duration : 1000</li>
<li>lv, totalLevel : 1</li>
</ul>
<div class="codemirror" lang="timbre" source="var env = T(&quot;env.tri&quot;, {dur:1500}, T(&quot;sin&quot;)).on(&quot;ended&quot;, function() {
  this.pause();
}).bang().play();

env.plot({target:env_tri});"></div>
<h3>T(&quot;env.cutoff&quot;)</h3>
<canvas id="env_cutoff" style="width:240px;height:80px"></canvas>
<p> <code>T(&quot;env.cutoff&quot;)</code> はカットオフエンベロープを作ります。

</p>
<ul>
<li>r, releaseTime : 100</li>
<li>lv, totalLevel : 1</li>
</ul>
<div class="codemirror" lang="timbre" source="var env = T(&quot;env.cutoff&quot;, {r:&quot;BPM120 4.0.0&quot;}, T(&quot;sin&quot;)).on(&quot;ended&quot;, function() {
  this.pause();
}).bang().play();

env.plot({target:env_cutoff});"></div>
<h2>Source</h2>
<p><a href="https://github.com/mohayonao/timbre.js/blob/master/src/objects/env.js">https://github.com/mohayonao/timbre.js/blob/master/src/objects/env.js</a>
</p>
</div><script src="/timbre.js/misc/js/jquery.js"></script><script src="/timbre.js/misc/js/codemirror.js"></script><script src="/timbre.js/misc/js/javascript.js"></script><script src="/timbre.js/misc/js/xml.js"></script><script src="/timbre.js/misc/js/htmlmixed.js"></script><script src="/timbre.js/misc/js/subcollider.js"></script><script src="/timbre.js/misc/js/common.js"></script></body></html>