<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Custom Object</title><link rel="stylesheet" href="/timbre.js/misc/css/codemirror.css" type="text/css"><link rel="stylesheet" href="/timbre.js/misc/css/common.css" type="text/css"><link rel="shortcut icon" href="/timbre.js/favicon.ico"><script src="/timbre.js/timbre.dev.js"></script><script>var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-21613416-10']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script></head><body><div class="container"><div class="row"><div id="sidebar"><h1>timbre.js</h1><div id="index"><div id="list"><h2>Download (v13.02.02)</h2><ul><li><a href="/timbre.js/timbre.js">timbre.js</a></li><li><a href="/timbre.js/timbre.dev.js">timbre.dev.js</a></li></ul><h2>Documents</h2><ul><li><a href="./">Introduction</a></li><li><a href="./GettingStarted.html">Getting Started</a></li><li><a href="./PragmaSynth.html">Pragmatic Synth</a></li><li><a href="./RecordingMode.html">Recording Mode</a></li><li><a href="./CustomObject.html">Custom Object</a></li><li><a href="./ForDevelopers.html">For Developers</a></li><li><a href="./timevalue.html">timevalue</a></li></ul><h2>Examples</h2><ul><li><a href="./beatbox.html">BeatBox</a></li><li><a href="./chord.html">Chords Work</a></li><li><a href="./satie.html">Gymnopedie</a></li><li><a href="./khoomii.html">Khoomii</a></li><li><a href="./reich.html">Reich</a></li></ul><h2>References</h2><ul><li><a href="./BaseObject.html">Base Object</a></li><li><a href="./Number.html">Number</a></li><li><a href="./Array.html">Array</a></li><li><a href="./Function.html">Function</a></li><li><a href="./Boolean.html">Boolean</a></li><li><a href="./Object.html">Object</a></li><li><a href="./SynthDef.html">SynthDef</a></li><li><a href="./soundbuffer.html">SoundBuffer</a></li><li><a href="./mul.html">*</a></li><li><a href="./add.html">+</a></li><li><a href="./subtract.html">-</a></li><li><a href="./div.html">/</a></li><li><a href="./audio.html">audio</a></li><li><a href="./biquad.html">biquad</a></li><li><a href="./buffer.html">buffer</a></li><li><a href="./chorus.html">chorus</a></li><li><a href="./clip.html">clip</a></li><li><a href="./comp.html">comp</a></li><li><a href="./cosc.html">cosc</a></li><li><a href="./delay.html">delay</a></li><li><a href="./dist.html">dist</a></li><li><a href="./env.html">env</a></li><li><a href="./eq.html">eq</a></li><li><a href="./fft.html">fft</a></li><li><a href="./fnoise.html">fnoise</a></li><li><a href="./gate.html">gate</a></li><li><a href="./ifft.html">ifft</a></li><li><a href="./interval.html">interval</a></li><li><a href="./keyboard.html">keyboard</a></li><li><a href="./map.html">map</a></li><li><a href="./max.html">max</a></li><li><a href="./mediastream.html">mediastream</a></li><li><a href="./midicps.html">midicps</a></li><li><a href="./midiratio.html">midiratio</a></li><li><a href="./min.html">min</a></li><li><a href="./mml.html">mml</a></li><li><a href="./mouse.html">mouse</a></li><li><a href="./ndict.html">ndict</a></li><li><a href="./noise.html">noise</a></li><li><a href="./osc.html">osc</a></li><li><a href="./OscGen.html">OscGen</a></li><li><a href="./panner.html">pan</a></li><li><a href="./param.html">param</a></li><li><a href="./phaser.html">phaser</a></li><li><a href="./pink.html">pink</a></li><li><a href="./pluck.html">pluck</a></li><li><a href="./PluckGen.html">PluckGen</a></li><li><a href="./rec.html">record</a></li><li><a href="./reverb.html">reverb</a></li><li><a href="./schedule.html">schedule</a></li><li><a href="./scope.html">scope</a></li><li><a href="./selector.html">selector</a></li><li><a href="./spectrum.html">spectrum</a></li><li><a href="./tape.html">tape</a></li><li><a href="./timeout.html">timeout</a></li><li><a href="./zmap.html">zmap</a></li></ul><h2>Extra objects</h2><ul><li><a href="./MoogFF.html">MoogFF</a></li><li><a href="./webaudioapi.html">WebAudioAPI</a></li></ul></div></div><hr><div id="footer"><a href="/timbre.js/">English</a><a href="/timbre.js/ja/">日本語</a></div></div><div id="main"><h1>Custom Object</h1>
<p>Customize timbre.js

</p>
<h2>Description</h2>
<p>自作のオブジェクトの作り方について解説します。<br>標準の T オブジェクトもすべて同じように書かれているので、詳しくは<a href="https://github.com/mohayonao/timbre.js/blob/master/src/objects/">ソースコード</a>を参照してください。

</p>
<p>以下の例は入力値を 2乗して出力する <em>(line:16)</em> カスタムオブジェクトです。

</p>
<div class="codemirror" lang="timbre" source="(function() {
  &quot;use strict&quot;;

  function CustomObject(_args) {
    timbre.Object.call(this, _args);
  }
  timbre.fn.extend(CustomObject);

  CustomObject.prototype.process = function(tickID) {
    if (this.tickID !== tickID) {
      this.tickID = tickID;

      timbre.fn.inputSignalAR(this);

      for (var i = 0; i &lt; this.cell.length; i++) {
        this.cell[i] = this.cell[i] * this.cell[i];
      }

      timbre.fn.outputSignalAR(this);
    }
    return this.cell;
  };

  timbre.fn.register(&quot;custom-object&quot;, CustomObject);
})();

T(&quot;custom-object&quot;, 
    T(&quot;audio&quot;, {load:&quot;/timbre.js/misc/audio/amen.wav&quot;, loop:true})
).play();"></div>
<h3>必須</h3>
<ul>
<li><code>timbre.Object.call(this, _args);</code> <em>(line:5)</em><ul>
<li>インスタンスを T オブジェクト として初期化します</li>
</ul>
</li>
<li><code>timbre.fn.extend(CustomObject);</code> <em>(line:7)</em><ul>
<li>T オブジェクトクラス を継承します</li>
</ul>
</li>
<li><code>CustomObject.prototype.process = function(tickID)</code> <em>(line:9)</em><ul>
<li>処理で呼ばれる関数です. 処理を行って <code>this.cell</code> を返します</li>
</ul>
</li>
<li><code>timbre.fn.register(&quot;custom-object&quot;, CustomObject);</code> <em>(line:24)</em><ul>
<li>クラスを登録する</li>
</ul>
</li>
</ul>
<h3>便利関数</h3>
<ul>
<li><code>timbre.fn.inputSignalAR(this);</code> <em>(line:13)</em><ul>
<li>入力オブジェクトの値を取得します ( <code>this.cell</code>を初期化して入力オブジェクトの値を加算します )</li>
</ul>
</li>
<li><code>timbre.fn.outputSignalAR(this);</code> <em>(line:19)</em><ul>
<li>出力値を調整します ( output * mul + add します )</li>
</ul>
</li>
</ul>
<h3>tickID</h3>
<p>通番をチェックすることで、ひとつのオブジェクトが複数のオブジェクトに入力されているときに起こる 二重処理を防止しています。

</p>
<h3>プライベート変数</h3>
<p>歴史的な理由で <code>this._</code> 以下に設置しています。

</p>
<div class="codemirror" lang="js" source="function CustomObject(_args) {
  timbre.Object.call(this, _args);

  this._.private1 =  0;
  this._.private2 = 10;
}"></div>
<h3>プロパティ</h3>
<p><code>set()</code>, <code>get()</code> で扱えるプロパティを作成するときは <code>defineProperties</code> します。
</p>
<div class="codemirror" lang="js" source="Object.defineProperties(CustomObject.prototype, {
  property: {
    set: function(value) {
      this._.property = timbre(value);
    },
    get: function() {
      return this._.property;
    }
  }
});

T(&quot;custom-object&quot;, {property:1});"></div>
<h3>Case of Coffee-Script</h3>
<p>like this.
</p>
<div class="codemirror" lang="js" source="class CustomObject extends timbre.Object
  constructor: (_args)-&gt;
    @super _args

  process: (tickID)-&gt;
    @cell"></div>
</div></div></div><script src="/timbre.js/misc/js/jquery.js"></script><script src="/timbre.js/misc/js/codemirror.js"></script><script src="/timbre.js/misc/js/javascript.js"></script><script src="/timbre.js/misc/js/subcollider.js"></script><script>sc.use("prototype");
window.pico = {};</script><script src="/timbre.js/libs/PicoFlashPlayer.js"></script><script src="/timbre.js/misc/js/requestAnimationFrame.js"></script><script src="/timbre.js/misc/js/common.js"></script></body></html>