(function(e){"use strict";function t(t){return r?r:(r=this,e.Object.call(this,1,t),this.X=new e.ChannelObject(this),this.Y=new e.ChannelObject(this),this.cells[3]=this.X.cell,this.cells[4]=this.Y.cell,i.fixKR(this),void 0)}function n(n){e.Object.call(this,1,n),r||(r=new t([])),i.fixKR(this)}if("browser"===e.envtype){var i=e.fn,r=null;i.extend(t);var s=0,o=0,a=function(e){r._.emit("click",e)},c=function(e){r._.emit("mousedown",e)},u=function(e){for(var t=s=e.clientX/window.innerWidth,n=o=e.clientY/window.innerHeight,i=r.cells[3],a=r.cells[4],c=0,u=i.length;u>c;++c)i[c]=t,a[c]=n},f=function(e){r._.emit("mouseup",e)},l=t.prototype;l.start=function(){return window.addEventListener("click",a,!0),window.addEventListener("mousedown",c,!0),window.addEventListener("mousemove",u,!0),window.addEventListener("mouseup",f,!0),this},l.stop=function(){return window.removeEventListener("click",a,!0),window.removeEventListener("mousedown",c,!0),window.removeEventListener("mousemove",u,!0),window.removeEventListener("mouseup",f,!0),this},l.play=l.pause=function(){return this},i.register("mouse",t),i.extend(n),Object.defineProperties(n.prototype,{min:{set:function(e){var t=this._;t.min=e,t.delta=t.max-t.min,t.map.bang()},get:function(){return this._.min}},max:{set:function(e){var t=this._;t.max=e,t.delta=t.max-t.min,t.map.bang()},get:function(){return this._.max}},curve:{set:function(e){var t=this._;if(h[e]){var n=h[e];t.map.map=function(e){return n(t,e)},t.map.bang(),t.curveName=e}},get:function(){return this._.curveName}}}),n.prototype.start=function(){return r.start(),this},n.prototype.stop=function(){return r.stop(),this},n.prototype.process=function(e){return this._.map.process(e),this};var h={lin:function(e,t){return t*e.delta+e.min},exp:function(e,t){var n=0>e.min?1e-6:e.min;return Math.pow(e.max/n,t)*n},sqr:function(e,t){return t*t*e.delta+e.min},cub:function(e,t){return t*t*t*e.delta+e.min}};i.register("mouse.x",function(t){var i=new n(t),s=i._;s.min=0,s.max=1,s.delta=1,s.curveName="lin";var o=h.lin;return s.map=e("map",{map:function(e){return o(s,e)}},r.X),i.cells[0]=s.map.cells[0],i}),i.register("mouse.y",function(t){var i=new n(t),s=i._;s.min=0,s.max=1,s.delta=1,s.curveName="lin";var o=h.lin;return s.map=e("map",{map:function(e){return o(s,e)}},r.Y),i.cells[0]=s.map.cells[0],i})}})(timbre);